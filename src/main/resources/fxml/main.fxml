<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.rise.client.ui.MainController"
      spacing="10" style="-fx-padding: 20;">

    <!-- Header -->
    <HBox spacing="10" alignment="CENTER_LEFT">
        <Label text="RISE Client" style="-fx-font-size: 24; -fx-font-weight: bold;"/>
        <Region HBox.hgrow="ALWAYS"/>
    </HBox>

    <!-- Server Selection -->
    <VBox spacing="5">
        <Label text="Servers:"/>
        <HBox spacing="10">
            <ListView fx:id="serverListView" onMouseClicked="#onServerSelected"
                      prefWidth="300" prefHeight="100"/>
            <VBox spacing="5">
                <Button text="Add Server" onAction="#onAddServer" prefWidth="100"/>
                <Button text="Remove" onAction="#onRemoveServer" prefWidth="100"/>
            </VBox>
        </HBox>
    </VBox>

    <!-- Main Tabs -->
    <TabPane fx:id="mainTabPane" prefHeight="500" disable="true">

        <!-- Firewall Tab -->
        <Tab fx:id="firewallTab" text="Firewall">
            <VBox spacing="10" style="-fx-padding: 10;">
                <Label text="Port Scanning &amp; Rules" style="-fx-font-size: 16;"/>

                <HBox spacing="10">
                    <Button fx:id="scanPortsButton" text="Scan Ports" onAction="#onScanPorts"/>
                    <Button fx:id="applyRulesButton" text="Apply Rules" onAction="#onApplyRules"/>
                    <Button fx:id="confirmRulesButton" text="Confirm" onAction="#onConfirmRules" disable="true"/>
                    <Button fx:id="rollbackRulesButton" text="Rollback" onAction="#onRollbackRules"/>
                </HBox>

                <TableView fx:id="firewallRulesTable">
                    <columns>
                        <TableColumn text="Port" prefWidth="80"/>
                        <TableColumn text="Protocol" prefWidth="80"/>
                        <TableColumn text="Action" prefWidth="80"/>
                        <TableColumn text="CIDR" prefWidth="150"/>
                        <TableColumn text="Status" prefWidth="100"/>
                    </columns>
                </TableView>

                <HBox spacing="10">
                    <TextField fx:id="portField" promptText="Port" prefWidth="80"/>
                    <ComboBox fx:id="protoCombo" prefWidth="100"/>
                    <ComboBox fx:id="actionCombo" prefWidth="100"/>
                    <TextField fx:id="cidrField" promptText="CIDR (optional)" prefWidth="150"/>
                    <Button fx:id="addRuleButton" text="Add Rule" onAction="#onAddRule"/>
                    <Button fx:id="removeRuleButton" text="Remove" onAction="#onRemoveRule"/>
                </HBox>
            </VBox>
        </Tab>

        <!-- Docker Tab -->
        <Tab fx:id="dockerTab" text="Docker">
            <VBox spacing="10" style="-fx-padding: 10;">
                <Label text="Container Management" style="-fx-font-size: 16;"/>

                <HBox spacing="10">
                    <Button fx:id="refreshDockerButton" text="Refresh" onAction="#onRefreshDocker"/>
                </HBox>

                <TableView fx:id="dockerContainerTable">
                    <columns>
                        <TableColumn text="ID" prefWidth="120"/>
                        <TableColumn text="Name" prefWidth="200"/>
                        <TableColumn text="State" prefWidth="100"/>
                        <TableColumn text="Image" prefWidth="200"/>
                    </columns>
                </TableView>

                <HBox spacing="10">
                    <Button fx:id="startContainerButton" text="Start" onAction="#onStartContainer"/>
                    <Button fx:id="stopContainerButton" text="Stop" onAction="#onStopContainer"/>
                    <Button fx:id="restartContainerButton" text="Restart" onAction="#onRestartContainer"/>
                </HBox>
            </VBox>
        </Tab>

        <!-- Updates Tab -->
        <Tab fx:id="updatesTab" text="Updates">
            <VBox spacing="10" style="-fx-padding: 10;">
                <Label text="System Updates" style="-fx-font-size: 16;"/>

                <HBox spacing="10">
                    <Button fx:id="checkUpdatesButton" text="Check Updates" onAction="#onCheckUpdates"/>
                    <Button fx:id="upgradeSystemButton" text="Upgrade System" onAction="#onUpgradeSystem"/>
                </HBox>

                <TextArea fx:id="updatesOutput" editable="false" prefHeight="300"/>
            </VBox>
        </Tab>

        <!-- Health Tab -->
        <Tab fx:id="healthTab" text="Health">
            <VBox spacing="10" style="-fx-padding: 10;">
                <Label text="Server Health Check" style="-fx-font-size: 16;"/>

                <Button fx:id="checkHealthButton" text="Run Health Check" onAction="#onCheckHealth"/>

                <GridPane hgap="10" vgap="10">
                    <Label text="Sudoers File:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="sudoersStatusLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="SSH Config:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="sshConfigStatusLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Nftables Include:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="nftablesStatusLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                    <Label text="Scripts Present:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                    <Label fx:id="scriptsStatusLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                </GridPane>
            </VBox>
        </Tab>
    </TabPane>

    <!-- Status Bar -->
    <Label fx:id="statusLabel" text="Ready"/>
</VBox>
